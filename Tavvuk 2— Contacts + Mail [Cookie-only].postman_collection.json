{
	"info": {
		"_postman_id": "c7b0d8c6-4a07-4c7a-9a64-3f8f5a6c6f11",
		"name": "Tavvuk — Auth + Orders [Cookie-only]",
		"description": "Cookie-only auth (login Set-Cookie) + Orders workflow endpoints. No Bearer header. Products/Locations moved to separate collection.",
		"schema": "https://schema.getpostman.com/json/collection/v2.1.0/collection.json"
	},
	"event": [
		{
			"listen": "prerequest",
			"script": {
				"type": "text/javascript",
				"exec": [
					"// Global pre-request: stable timestamp per run",
					"if (!pm.environment.get('timestamp')) pm.environment.set('timestamp', Date.now().toString());",
					"if (!pm.environment.get('order_number')) pm.environment.set('order_number', 'ORD-' + pm.environment.get('timestamp'));"
				]
			}
		}
	],
	"variable": [
		{
			"key": "base_url",
			"value": "http://localhost:8071"
		},
		{
			"key": "admin_email",
			"value": "admin@tavvuk.local"
		},
		{
			"key": "admin_password",
			"value": "Admin123!"
		},
		{
			"key": "seller_email",
			"value": "seller@tavvuk.local"
		},
		{
			"key": "seller_password",
			"value": "Seller123!"
		},
		{
			"key": "driver_email",
			"value": "driver@tavvuk.local"
		},
		{
			"key": "driver_password",
			"value": "Driver123!"
		},
		{
			"key": "city_id",
			"value": ""
		},
		{
			"key": "district_id",
			"value": ""
		},
		{
			"key": "product_id",
			"value": ""
		},
		{
			"key": "product_id_2",
			"value": ""
		},
		{
			"key": "order_id",
			"value": ""
		},
		{
			"key": "order_item_id_1",
			"value": ""
		},
		{
			"key": "order_item_id_2",
			"value": ""
		},
		{
			"key": "driver_id",
			"value": ""
		}
	],
	"item": [
		{
			"name": "Auth (Cookie-only)",
			"item": [
				{
					"name": "00) Auth: Clear runtime vars",
					"event": [
						{
							"listen": "test",
							"script": {
								"type": "text/javascript",
								"exec": [
									"pm.environment.unset('order_id');",
									"pm.environment.unset('order_item_id_1');",
									"pm.environment.unset('order_item_id_2');",
									"pm.environment.unset('driver_id');",
									"pm.environment.unset('admin_user_id');",
									"pm.environment.unset('seller_user_id');",
									"pm.environment.unset('driver_user_id');",
									"pm.test('vars cleared', () => pm.expect(true).to.eql(true));"
								]
							}
						}
					],
					"request": {
						"method": "GET",
						"header": [],
						"url": {
							"raw": "{{base_url}}/api/health",
							"host": [
								"{{base_url}}"
							],
							"path": [
								"api",
								"health"
							]
						}
					},
					"response": []
				},
				{
					"name": "01) Auth: Login as ADMIN (sets cookie)",
					"event": [
						{
							"listen": "test",
							"script": {
								"type": "text/javascript",
								"exec": [
									"pm.test('200/204/302', () => pm.expect([200,204,302]).to.include(pm.response.code));",
									"// Cookie Jar will store Set-Cookie automatically.",
									"pm.environment.set('auth_actor', 'admin');"
								]
							}
						}
					],
					"request": {
						"method": "POST",
						"header": [
							{
								"key": "Content-Type",
								"value": "application/json"
							}
						],
						"body": {
							"mode": "raw",
							"raw": "{\n  \"email\": \"{{admin_email}}\",\n  \"password\": \"{{admin_password}}\"\n}"
						},
						"url": {
							"raw": "{{base_url}}/api/auth/login",
							"host": [
								"{{base_url}}"
							],
							"path": [
								"api",
								"auth",
								"login"
							]
						}
					},
					"response": []
				},
				{
					"name": "02) Auth: Status (ADMIN) → set admin_user_id",
					"event": [
						{
							"listen": "test",
							"script": {
								"type": "text/javascript",
								"exec": [
									"pm.test('200 OK', () => pm.response.to.have.status(200));",
									"const body = pm.response.json();",
									"pm.test('user exists', () => pm.expect(body).to.have.property('user'));",
									"const u = body.user || {};",
									"const id = u.id || u.user_id || u.sub;",
									"if (id) pm.environment.set('admin_user_id', id);",
									"pm.test('admin_user_id set', () => pm.expect(pm.environment.get('admin_user_id')).to.be.a('string').and.not.empty);"
								]
							}
						}
					],
					"request": {
						"method": "GET",
						"header": [],
						"url": {
							"raw": "{{base_url}}/api/auth/status",
							"host": [
								"{{base_url}}"
							],
							"path": [
								"api",
								"auth",
								"status"
							]
						}
					},
					"response": []
				},
				{
					"name": "03) Auth: Logout (ADMIN) (optional)",
					"event": [
						{
							"listen": "test",
							"script": {
								"type": "text/javascript",
								"exec": [
									"pm.test('200/204', () => pm.expect([200,204]).to.include(pm.response.code));"
								]
							}
						}
					],
					"request": {
						"method": "POST",
						"header": [],
						"url": {
							"raw": "{{base_url}}/api/auth/logout",
							"host": [
								"{{base_url}}"
							],
							"path": [
								"api",
								"auth",
								"logout"
							]
						}
					},
					"response": []
				},
				{
					"name": "04) Auth: Login as SELLER (sets cookie)",
					"event": [
						{
							"listen": "test",
							"script": {
								"type": "text/javascript",
								"exec": [
									"pm.test('200/204/302', () => pm.expect([200,204,302]).to.include(pm.response.code));",
									"pm.environment.set('auth_actor', 'seller');"
								]
							}
						}
					],
					"request": {
						"method": "POST",
						"header": [
							{
								"key": "Content-Type",
								"value": "application/json"
							}
						],
						"body": {
							"mode": "raw",
							"raw": "{\n  \"email\": \"{{seller_email}}\",\n  \"password\": \"{{seller_password}}\"\n}"
						},
						"url": {
							"raw": "{{base_url}}/api/auth/login",
							"host": [
								"{{base_url}}"
							],
							"path": [
								"api",
								"auth",
								"login"
							]
						}
					},
					"response": []
				},
				{
					"name": "05) Auth: Status (SELLER) → set seller_user_id",
					"event": [
						{
							"listen": "test",
							"script": {
								"type": "text/javascript",
								"exec": [
									"pm.test('200 OK', () => pm.response.to.have.status(200));",
									"const body = pm.response.json();",
									"const u = body.user || {};",
									"const id = u.id || u.user_id || u.sub;",
									"if (id) pm.environment.set('seller_user_id', id);",
									"pm.test('seller_user_id set', () => pm.expect(pm.environment.get('seller_user_id')).to.be.a('string').and.not.empty);"
								]
							}
						}
					],
					"request": {
						"method": "GET",
						"header": [],
						"url": {
							"raw": "{{base_url}}/api/auth/status",
							"host": [
								"{{base_url}}"
							],
							"path": [
								"api",
								"auth",
								"status"
							]
						}
					},
					"response": []
				},
				{
					"name": "06) Auth: Logout (SELLER) (optional)",
					"event": [
						{
							"listen": "test",
							"script": {
								"type": "text/javascript",
								"exec": [
									"pm.test('200/204', () => pm.expect([200,204]).to.include(pm.response.code));"
								]
							}
						}
					],
					"request": {
						"method": "POST",
						"header": [],
						"url": {
							"raw": "{{base_url}}/api/auth/logout",
							"host": [
								"{{base_url}}"
							],
							"path": [
								"api",
								"auth",
								"logout"
							]
						}
					},
					"response": []
				},
				{
					"name": "07) Auth: Login as DRIVER (sets cookie)",
					"event": [
						{
							"listen": "test",
							"script": {
								"type": "text/javascript",
								"exec": [
									"pm.test('200/204/302', () => pm.expect([200,204,302]).to.include(pm.response.code));",
									"pm.environment.set('auth_actor', 'driver');"
								]
							}
						}
					],
					"request": {
						"method": "POST",
						"header": [
							{
								"key": "Content-Type",
								"value": "application/json"
							}
						],
						"body": {
							"mode": "raw",
							"raw": "{\n  \"email\": \"{{driver_email}}\",\n  \"password\": \"{{driver_password}}\"\n}"
						},
						"url": {
							"raw": "{{base_url}}/api/auth/login",
							"host": [
								"{{base_url}}"
							],
							"path": [
								"api",
								"auth",
								"login"
							]
						}
					},
					"response": []
				},
				{
					"name": "08) Auth: Status (DRIVER) → set driver_user_id + driver_id",
					"event": [
						{
							"listen": "test",
							"script": {
								"type": "text/javascript",
								"exec": [
									"pm.test('200 OK', () => pm.response.to.have.status(200));",
									"const body = pm.response.json();",
									"const u = body.user || {};",
									"const id = u.id || u.user_id || u.sub;",
									"if (id) {",
									"  pm.environment.set('driver_user_id', id);",
									"  if (!pm.environment.get('driver_id')) pm.environment.set('driver_id', id);",
									"}",
									"pm.test('driver_user_id set', () => pm.expect(pm.environment.get('driver_user_id')).to.be.a('string').and.not.empty);"
								]
							}
						}
					],
					"request": {
						"method": "GET",
						"header": [],
						"url": {
							"raw": "{{base_url}}/api/auth/status",
							"host": [
								"{{base_url}}"
							],
							"path": [
								"api",
								"auth",
								"status"
							]
						}
					},
					"response": []
				},
				{
					"name": "09) Auth: Logout (DRIVER) (optional)",
					"event": [
						{
							"listen": "test",
							"script": {
								"type": "text/javascript",
								"exec": [
									"pm.test('200/204', () => pm.expect([200,204]).to.include(pm.response.code));"
								]
							}
						}
					],
					"request": {
						"method": "POST",
						"header": [],
						"url": {
							"raw": "{{base_url}}/api/auth/logout",
							"host": [
								"{{base_url}}"
							],
							"path": [
								"api",
								"auth",
								"logout"
							]
						}
					},
					"response": []
				},
				{
					"name": "10) Admin Users: List (optional) — requires admin cookie",
					"event": [
						{
							"listen": "test",
							"script": {
								"type": "text/javascript",
								"exec": [
									"pm.test('200 OK', () => pm.response.to.have.status(200));",
									"pm.expect(pm.response.json()).to.be.an('array');"
								]
							}
						}
					],
					"request": {
						"method": "GET",
						"header": [],
						"url": {
							"raw": "{{base_url}}/api/admin/users?limit=50&offset=0",
							"host": [
								"{{base_url}}"
							],
							"path": [
								"api",
								"admin",
								"users"
							],
							"query": [
								{
									"key": "limit",
									"value": "50"
								},
								{
									"key": "offset",
									"value": "0"
								}
							]
						}
					},
					"response": []
				},
				{
					"name": "11) Admin Users: List Drivers (optional) → set driver_id from list",
					"event": [
						{
							"listen": "test",
							"script": {
								"type": "text/javascript",
								"exec": [
									"pm.test('200 OK', () => pm.response.to.have.status(200));",
									"const arr = pm.response.json();",
									"pm.expect(arr).to.be.an('array');",
									"if (arr.length && !pm.environment.get('driver_id')) pm.environment.set('driver_id', arr[0].id);",
									"pm.test('driver_id maybe set', () => pm.expect(true).to.eql(true));"
								]
							}
						}
					],
					"request": {
						"method": "GET",
						"header": [],
						"url": {
							"raw": "{{base_url}}/api/admin/users?role=driver&limit=50&offset=0",
							"host": [
								"{{base_url}}"
							],
							"path": [
								"api",
								"admin",
								"users"
							],
							"query": [
								{
									"key": "role",
									"value": "driver"
								},
								{
									"key": "limit",
									"value": "50"
								},
								{
									"key": "offset",
									"value": "0"
								}
							]
						}
					},
					"response": []
				},
				{
					"name": "12) Admin Users: List Sellers (optional)",
					"event": [
						{
							"listen": "test",
							"script": {
								"type": "text/javascript",
								"exec": [
									"pm.test('200 OK', () => pm.response.to.have.status(200));",
									"pm.expect(pm.response.json()).to.be.an('array');"
								]
							}
						}
					],
					"request": {
						"method": "GET",
						"header": [],
						"url": {
							"raw": "{{base_url}}/api/admin/users?role=seller&limit=50&offset=0",
							"host": [
								"{{base_url}}"
							],
							"path": [
								"api",
								"admin",
								"users"
							],
							"query": [
								{
									"key": "role",
									"value": "seller"
								},
								{
									"key": "limit",
									"value": "50"
								},
								{
									"key": "offset",
									"value": "0"
								}
							]
						}
					},
					"response": []
				}
			]
		},
		{
			"name": "Orders (Public)",
			"item": [
				{
					"name": "01) Orders: Create (submitted) → set order_id + order_item_ids",
					"event": [
						{
							"listen": "test",
							"script": {
								"type": "text/javascript",
								"exec": [
									"pm.test('201 Created', () => pm.response.to.have.status(201));",
									"const body = pm.response.json();",
									"pm.test('order id', () => pm.expect(body.order && body.order.id).to.be.a('string').and.not.empty);",
									"pm.environment.set('order_id', body.order.id);",
									"pm.test('items array', () => pm.expect(body.items).to.be.an('array').and.not.empty);",
									"if (body.items && body.items.length) pm.environment.set('order_item_id_1', body.items[0].id);",
									"if (body.items && body.items.length > 1) pm.environment.set('order_item_id_2', body.items[1].id);",
									"pm.test('status submitted', () => pm.expect(body.order.status).to.eql('submitted'));"
								]
							}
						}
					],
					"request": {
						"method": "POST",
						"header": [
							{
								"key": "Content-Type",
								"value": "application/json"
							}
						],
						"body": {
							"mode": "raw",
							"raw": "{\n  \"city_id\": \"{{city_id}}\",\n  \"district_id\": \"{{district_id}}\",\n  \"customer_name\": \"Test Müşteri {{timestamp}}\",\n  \"customer_phone\": \"+90 533 000 00 00\",\n  \"address_text\": \"Test adres {{timestamp}}\",\n  \"items\": [\n    { \"product_id\": \"{{product_id}}\", \"qty_ordered\": 10 },\n    { \"product_id\": \"{{product_id_2}}\", \"qty_ordered\": 5 }\n  ]\n}"
						},
						"url": {
							"raw": "{{base_url}}/api/orders",
							"host": [
								"{{base_url}}"
							],
							"path": [
								"api",
								"orders"
							]
						}
					},
					"response": []
				},
				{
					"name": "02) Orders: List My Orders",
					"event": [
						{
							"listen": "test",
							"script": {
								"type": "text/javascript",
								"exec": [
									"pm.test('200 OK', () => pm.response.to.have.status(200));",
									"const arr = pm.response.json();",
									"pm.expect(arr).to.be.an('array');",
									"const id = pm.environment.get('order_id');",
									"if (id && arr.length) pm.test('created order exists in list (best effort)', () => pm.expect(arr.some(x => x.id === id)).to.eql(true));"
								]
							}
						}
					],
					"request": {
						"method": "GET",
						"header": [],
						"url": {
							"raw": "{{base_url}}/api/orders?limit=50&offset=0&direction=desc",
							"host": [
								"{{base_url}}"
							],
							"path": [
								"api",
								"orders"
							],
							"query": [
								{
									"key": "limit",
									"value": "50"
								},
								{
									"key": "offset",
									"value": "0"
								},
								{
									"key": "direction",
									"value": "desc"
								}
							]
						}
					},
					"response": []
				},
				{
					"name": "03) Orders: Get Detail (public)",
					"event": [
						{
							"listen": "test",
							"script": {
								"type": "text/javascript",
								"exec": [
									"pm.test('order_id var', () => pm.expect(pm.environment.get('order_id')).to.be.a('string').and.not.empty);",
									"pm.test('200 OK', () => pm.response.to.have.status(200));",
									"const body = pm.response.json();",
									"pm.test('order.id matches', () => pm.expect(body.order.id).to.eql(pm.environment.get('order_id')));",
									"pm.test('items exists', () => pm.expect(body.items).to.be.an('array'));"
								]
							}
						}
					],
					"request": {
						"method": "GET",
						"header": [],
						"url": {
							"raw": "{{base_url}}/api/orders/{{order_id}}",
							"host": [
								"{{base_url}}"
							],
							"path": [
								"api",
								"orders",
								"{{order_id}}"
							]
						}
					},
					"response": []
				},
				{
					"name": "04) Orders: Patch (only submitted & own) — change phone/address",
					"event": [
						{
							"listen": "test",
							"script": {
								"type": "text/javascript",
								"exec": [
									"pm.test('200 OK or 409', () => pm.expect([200,409]).to.include(pm.response.code));",
									"if (pm.response.code === 200) {",
									"  const body = pm.response.json();",
									"  pm.test('updated phone ok', () => pm.expect(body.order.customer_phone).to.eql('+90 533 111 11 11'));",
									"} else {",
									"  const err = pm.response.json();",
									"  pm.test('conflict message exists', () => pm.expect(err.error && err.error.message).to.be.a('string'));",
									"}"
								]
							}
						}
					],
					"request": {
						"method": "PATCH",
						"header": [
							{
								"key": "Content-Type",
								"value": "application/json"
							}
						],
						"body": {
							"mode": "raw",
							"raw": "{\n  \"customer_phone\": \"+90 533 111 11 11\",\n  \"address_text\": \"Patch adres {{timestamp}}\"\n}"
						},
						"url": {
							"raw": "{{base_url}}/api/orders/{{order_id}}",
							"host": [
								"{{base_url}}"
							],
							"path": [
								"api",
								"orders",
								"{{order_id}}"
							]
						}
					},
					"response": []
				}
			]
		},
		{
			"name": "Orders (Admin)",
			"item": [
				{
					"name": "01) Admin Orders: List (status filter) → set order_id if empty",
					"event": [
						{
							"listen": "test",
							"script": {
								"type": "text/javascript",
								"exec": [
									"pm.test('200 OK', () => pm.response.to.have.status(200));",
									"const arr = pm.response.json();",
									"pm.expect(arr).to.be.an('array');",
									"if (!pm.environment.get('order_id') && arr.length) pm.environment.set('order_id', arr[0].id);"
								]
							}
						}
					],
					"request": {
						"method": "GET",
						"header": [],
						"url": {
							"raw": "{{base_url}}/api/admin/orders?status=submitted&limit=50&offset=0&sort=created_at&order=desc",
							"host": [
								"{{base_url}}"
							],
							"path": [
								"api",
								"admin",
								"orders"
							],
							"query": [
								{
									"key": "status",
									"value": "submitted"
								},
								{
									"key": "limit",
									"value": "50"
								},
								{
									"key": "offset",
									"value": "0"
								},
								{
									"key": "sort",
									"value": "created_at"
								},
								{
									"key": "order",
									"value": "desc"
								}
							]
						}
					},
					"response": []
				},
				{
					"name": "02) Admin Orders: Get Detail",
					"event": [
						{
							"listen": "test",
							"script": {
								"type": "text/javascript",
								"exec": [
									"pm.test('order_id var', () => pm.expect(pm.environment.get('order_id')).to.be.a('string').and.not.empty);",
									"pm.test('200 OK', () => pm.response.to.have.status(200));",
									"const body = pm.response.json();",
									"pm.test('order.id matches', () => pm.expect(body.order.id).to.eql(pm.environment.get('order_id')));",
									"pm.test('items array', () => pm.expect(body.items).to.be.an('array'));"
								]
							}
						}
					],
					"request": {
						"method": "GET",
						"header": [],
						"url": {
							"raw": "{{base_url}}/api/admin/orders/{{order_id}}",
							"host": [
								"{{base_url}}"
							],
							"path": [
								"api",
								"admin",
								"orders",
								"{{order_id}}"
							]
						}
					},
					"response": []
				},
				{
					"name": "03) Admin Orders: Approve (submitted → approved)",
					"event": [
						{
							"listen": "test",
							"script": {
								"type": "text/javascript",
								"exec": [
									"pm.test('200 OK or 409', () => pm.expect([200,409]).to.include(pm.response.code));",
									"if (pm.response.code === 200) {",
									"  const body = pm.response.json();",
									"  pm.test('ok:true', () => pm.expect(body.ok).to.eql(true));",
									"} else {",
									"  const err = pm.response.json();",
									"  pm.test('conflict message exists', () => pm.expect(err.error && err.error.message).to.be.a('string'));",
									"}"
								]
							}
						}
					],
					"request": {
						"method": "POST",
						"header": [],
						"url": {
							"raw": "{{base_url}}/api/admin/orders/{{order_id}}/approve",
							"host": [
								"{{base_url}}"
							],
							"path": [
								"api",
								"admin",
								"orders",
								"{{order_id}}",
								"approve"
							]
						}
					},
					"response": []
				},
				{
					"name": "04) Admin Orders: Assign Driver (approved → assigned)",
					"event": [
						{
							"listen": "test",
							"script": {
								"type": "text/javascript",
								"exec": [
									"pm.test('driver_id var', () => pm.expect(pm.environment.get('driver_id')).to.be.a('string').and.not.empty);",
									"pm.test('200 OK or 409/400', () => pm.expect([200,400,409]).to.include(pm.response.code));",
									"if (pm.response.code === 200) {",
									"  const body = pm.response.json();",
									"  pm.test('ok:true', () => pm.expect(body.ok).to.eql(true));",
									"} else {",
									"  const err = pm.response.json();",
									"  pm.test('error message exists', () => pm.expect(err.error && err.error.message).to.be.a('string'));",
									"}"
								]
							}
						}
					],
					"request": {
						"method": "POST",
						"header": [
							{
								"key": "Content-Type",
								"value": "application/json"
							}
						],
						"body": {
							"mode": "raw",
							"raw": "{\n  \"driver_id\": \"{{driver_id}}\"\n}"
						},
						"url": {
							"raw": "{{base_url}}/api/admin/orders/{{order_id}}/assign-driver",
							"host": [
								"{{base_url}}"
							],
							"path": [
								"api",
								"admin",
								"orders",
								"{{order_id}}",
								"assign-driver"
							]
						}
					},
					"response": []
				},
				{
					"name": "05) Admin Orders: Cancel (if not delivered) (optional)",
					"event": [
						{
							"listen": "test",
							"script": {
								"type": "text/javascript",
								"exec": [
									"pm.test('200 OK or 409', () => pm.expect([200,409]).to.include(pm.response.code));",
									"if (pm.response.code === 200) {",
									"  const body = pm.response.json();",
									"  pm.test('ok:true', () => pm.expect(body.ok).to.eql(true));",
									"} else {",
									"  const err = pm.response.json();",
									"  pm.test('conflict message exists', () => pm.expect(err.error && err.error.message).to.be.a('string'));",
									"}"
								]
							}
						}
					],
					"request": {
						"method": "POST",
						"header": [
							{
								"key": "Content-Type",
								"value": "application/json"
							}
						],
						"body": {
							"mode": "raw",
							"raw": "{\n  \"cancel_reason\": \"Postman cancel test {{timestamp}}\"\n}"
						},
						"url": {
							"raw": "{{base_url}}/api/admin/orders/{{order_id}}/cancel",
							"host": [
								"{{base_url}}"
							],
							"path": [
								"api",
								"admin",
								"orders",
								"{{order_id}}",
								"cancel"
							]
						}
					},
					"response": []
				}
			]
		},
		{
			"name": "Driver",
			"item": [
				{
					"name": "01) Driver: List (admin path) — /api/admin/driver/orders",
					"event": [
						{
							"listen": "test",
							"script": {
								"type": "text/javascript",
								"exec": [
									"pm.test('200 OK', () => pm.response.to.have.status(200));",
									"pm.expect(pm.response.json()).to.be.an('array');"
								]
							}
						}
					],
					"request": {
						"method": "GET",
						"header": [],
						"url": {
							"raw": "{{base_url}}/api/admin/driver/orders",
							"host": [
								"{{base_url}}"
							],
							"path": [
								"api",
								"admin",
								"driver",
								"orders"
							]
						}
					},
					"response": []
				},
				{
					"name": "02) Driver: List (driver path) — /api/driver/orders",
					"event": [
						{
							"listen": "test",
							"script": {
								"type": "text/javascript",
								"exec": [
									"pm.test('200 OK', () => pm.response.to.have.status(200));",
									"pm.expect(pm.response.json()).to.be.an('array');"
								]
							}
						}
					],
					"request": {
						"method": "GET",
						"header": [],
						"url": {
							"raw": "{{base_url}}/api/driver/orders",
							"host": [
								"{{base_url}}"
							],
							"path": [
								"api",
								"driver",
								"orders"
							]
						}
					},
					"response": []
				},
				{
					"name": "03) Driver: Deliver — /api/driver/orders/:id/deliver",
					"event": [
						{
							"listen": "test",
							"script": {
								"type": "text/javascript",
								"exec": [
									"pm.test('200 OK or 403/409', () => pm.expect([200,403,409]).to.include(pm.response.code));",
									"if (pm.response.code === 200) {",
									"  const body = pm.response.json();",
									"  pm.test('status delivered', () => pm.expect(body.order.status).to.eql('delivered'));",
									"  pm.test('delivered_qty_total number', () => pm.expect(body.order.delivered_qty_total).to.be.a('number'));",
									"} else {",
									"  const err = pm.response.json();",
									"  pm.test('error message exists', () => pm.expect(err.error && err.error.message).to.be.a('string'));",
									"}"
								]
							}
						}
					],
					"request": {
						"method": "POST",
						"header": [
							{
								"key": "Content-Type",
								"value": "application/json"
							}
						],
						"body": {
							"mode": "raw",
							"raw": "{\n  \"delivery_note\": \"Teslim edildi ({{timestamp}})\",\n  \"items\": [\n    { \"order_item_id\": \"{{order_item_id_1}}\", \"qty_delivered\": 10 },\n    { \"order_item_id\": \"{{order_item_id_2}}\", \"qty_delivered\": 4 }\n  ]\n}"
						},
						"url": {
							"raw": "{{base_url}}/api/driver/orders/{{order_id}}/deliver",
							"host": [
								"{{base_url}}"
							],
							"path": [
								"api",
								"driver",
								"orders",
								"{{order_id}}",
								"deliver"
							]
						}
					},
					"response": []
				}
			]
		}
	]
}